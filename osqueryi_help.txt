osquery 2.2.1, your OS as a high-performance relational database
Usage: osqueryi [OPTION]... [SQL STATEMENT]

osquery command line flags:

    --flagfile PATH                           Line-delimited file of additional flags
    --config_check                            Check the format of an osquery config and exit
    --config_dump                             Dump the contents of the configuration
    --config_path VALUE                       Path to JSON config file
    --config_plugin VALUE                     Config plugin name
    --config_tls_endpoint VALUE               TLS/HTTPS endpoint for config retrieval
    --config_tls_max_attempts VALUE           Number of attempts to retry a TLS config/enroll request
    --config_tls_refresh VALUE                Optional interval in seconds to re-read configuration
    --daemonize                               Run as daemon (osqueryd only)
    --database_dump                           Dump the contents of the backing store
    --database_path VALUE                     If using a disk-based backing store, specify a path
    --disable_enrollment                      Disable enrollment functions on related config/logger plugins
    --disable_extensions                      Disable extension API
    --disable_reenrollment                    Disable re-enrollment attempts if related plugins return invalid
    --disable_watchdog                        Disable userland watchdog process
    --enroll_always                           On startup, send a new enrollment request
    --enroll_secret_env VALUE                 Name of environment variable holding enrollment-auth secret
    --enroll_secret_path VALUE                Path to an optional client enrollment-auth secret
    --enroll_tls_endpoint VALUE               TLS/HTTPS endpoint for client enrollment
    --extensions_autoload VALUE               Optional path to a list of autoloaded & managed extensions
    --extensions_interval VALUE               Seconds delay between connectivity checks
    --extensions_require VALUE                Comma-separated list of required extensions
    --extensions_socket VALUE                 Path to the extensions UNIX domain socket
    --extensions_timeout VALUE                Seconds to wait for autoloaded extensions
    --force                                   Force osqueryd to kill previously-running daemons
    --modules_autoload VALUE                  Optional path to a list of autoloaded registry modules
    --pidfile VALUE                           Path to the daemon pidfile mutex
    --tls_client_cert VALUE                   Optional path to a TLS client-auth PEM certificate
    --tls_client_key VALUE                    Optional path to a TLS client-auth PEM private key
    --tls_hostname VALUE                      TLS/HTTPS hostname for Config, Logger, and Enroll plugins
    --tls_server_certs VALUE                  Optional path to a TLS server PEM certificate(s) bundle
    --watchdog_level VALUE                    Performance limit level (0=normal, 1=restrictive, -1=off)
    --watchdog_memory_limit VALUE             Override watchdog profile memory limit
    --watchdog_utilization_limit VALUE        Override watchdog profile CPU utilization limit

osquery configuration options (set by config or CLI flags):

    --audit_allow_config                      Allow the audit publisher to change auditing configuration
    --audit_allow_sockets                     Allow the audit publisher to install socket-related rules
    --audit_persist                           Attempt to retain control of audit
    --aws_access_key_id VALUE                 AWS access key ID
    --aws_firehose_period VALUE               Seconds between flushing logs to Firehose (default 10)
    --aws_firehose_stream VALUE               Name of Firehose stream for logging
    --aws_kinesis_period VALUE                Seconds between flushing logs to Kinesis (default 10)
    --aws_kinesis_random_partition_key        Enable random kinesis partition keys
    --aws_kinesis_stream VALUE                Name of Kinesis stream for logging
    --aws_profile_name VALUE                  AWS profile for authentication and region configuration
    --aws_region VALUE                        AWS region
    --aws_secret_access_key VALUE             AWS secret access key
    --aws_sts_arn_role VALUE                  AWS STS ARN role
    --aws_sts_region VALUE                    AWS STS region
    --aws_sts_session_name VALUE              AWS STS session name
    --aws_sts_timeout VALUE                   AWS STS assume role credential validity in seconds (default 3600)
    --buffered_log_max VALUE                  Maximum number of logs in buffered output plugins (0 = unlimited)
    --decorations_top_level                   Add decorators as top level JSON objects
    --disable_audit                           Disable receiving events from the audit subsystem
    --disable_caching                         Disable scheduled query caching
    --disable_database                        Disable the persistent RocksDB storage
    --disable_decorators                      Disable log result decoration
    --disable_distributed                     Disable distributed queries (default true)
    --disable_events                          Disable osquery publish/subscribe system
    --disable_kernel                          Disable osquery kernel extension
    --disable_logging                         Disable ERROR/INFO logging
    --disable_memory                          Disable physical memory reads
    --disable_tables VALUE                    Comma-delimited list of table names to be disabled
    --distributed_interval VALUE              Seconds between polling for new queries (default 60)
    --distributed_plugin VALUE                Distributed plugin name
    --distributed_tls_max_attempts VALUE      Number of times to attempt a request
    --distributed_tls_read_endpoint VALUE     TLS/HTTPS endpoint for distributed query retrieval
    --distributed_tls_write_endpoint VALUE    TLS/HTTPS endpoint for distributed query results
    --enable_foreign                          Enable no-op foreign virtual tables
    --enable_monitor                          Enable the schedule monitor
    --enable_syslog                           Enable the syslog ingestion event publisher
    --ephemeral                               Skip pidfile and database state checks
    --events_expiry VALUE                     Timeout to expire event subscriber results
    --events_max VALUE                        Maximum number of events per type to buffer
    --events_optimize                         Optimize subscriber select queries (scheduler only)
    --host_identifier VALUE                   Field used to identify the host running osquery (hostname, uuid)
    --logger_event_type                       Log scheduled results as events
    --logger_mode VALUE                       Decimal mode for log files (default '0640')
    --logger_path VALUE                       Directory path for ERROR/WARN/INFO and results logging
    --logger_plugin VALUE                     Logger plugin name
    --logger_secondary_status_only            Only send status logs to secondary logger plugins
    --logger_syslog_facility VALUE            Syslog facility for status and results logs (0-23, default 19)
    --logger_syslog_prepend_cee               Prepend @cee: tag to logged JSON messages
    --logger_tls_compress                     GZip compress TLS/HTTPS request body
    --logger_tls_endpoint VALUE               TLS/HTTPS endpoint for results logging
    --logger_tls_max VALUE                    Max size in bytes allowed per log line
    --logger_tls_period VALUE                 Seconds between flushing logs over TLS/HTTPS
    --pack_delimiter VALUE                    Delimiter for pack and query names
    --pack_refresh_interval VALUE             Cache expiration for a packs discovery queries
    --read_max VALUE                          Maximum file read size
    --read_user_max VALUE                     Maximum non-su read size
    --schedule_default_interval VALUE         Query interval to use if none is provided
    --schedule_splay_percent VALUE            Percent to splay config times
    --schedule_timeout VALUE                  Limit the schedule, 0 for no limit
    --syslog_events_expiry VALUE              Timeout to expire event subscriber results
    --syslog_events_max VALUE                 Maximum number of events per type to buffer
    --syslog_pipe_path VALUE                  Path to the named pipe used for forwarding rsyslog events
    --syslog_rate_limit VALUE                 Maximum number of logs to ingest per run (~200ms between runs)
    --utc                                     Convert all UNIX times to UTC
    --value_max VALUE                         Maximum returned row value size
    --verbose                                 Enable verbose informational messages
    --worker_threads VALUE                    Number of work dispatch threads

osquery shell-only CLI flags:

    --A VALUE                                 Select all from a table
    --L                                       List all table names
    --csv                                     Set output mode to 'csv'
    --extension VALUE                         Path to a single extension to autoload
    --header                                  Toggle column headers true/false
    --json                                    Set output mode to 'json'
    --line                                    Set output mode to 'line'
    --list                                    Set output mode to 'list'
    --nullvalue VALUE                         Set string for NULL values, default ''
    --pack VALUE                              Run all queries in a pack
    --planner                                 Enable osquery runtime planner output
    --profile VALUE                           Enable profile mode when non-0, set number of iterations
    --separator VALUE                         Set output field separator, default '|'

osquery project page <https://osquery.io>.
